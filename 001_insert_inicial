----Luego de subir la tabla al postgres, hay que generarle la columna de geom.
alter table telecom.dispositivos_2709 add column geom geometry 
select * from  telecom.dispositivos_1709 limit 10
---- para insert 
select max (day::date) from telecom.dispositivos_0711
select distinct (day::date) from telecom.dispositivos_2709
where day::date > '2020-09-24' order by day 



create table registros_insert as
SELECT id_2 as registro, uli_sitiorm_latitud as lat, uli_sitiorm_longitud as 
long,(ST_SetSRID(ST_MakePoint(uli_sitiorm_longitud , uli_sitiorm_latitud),4326))as geom,
cdl_provincia, cdl_localidad, 
sitiorm_agrupador_zona_de_servic as zona_serv, barrio,day::date,hora,lineas as cant_lineas
FROM telecom.dispositivos_2709 
where day in ('2020-09-18','2020-09-19','2020-09-20','2020-09-25','2020-09-26','2020-09-27') order by day 
				 
select distinct (day), count (*) 
from registros_insert
group by 1
order by day	 

				 
INSERT INTO telecom.dispositivos_0711(
	registro, lat, "long", geom, cdl_provincia, cdl_localidad, zona_serv, barrio, day, hora, cant_lineas)
select * from  registros_insert	
				 
 Drop table registros_insert
 

 
select distinct (hora), sum (cant_lineas)*3.3
from registros_insert
where day ='2020-09-27'
group by 1
				 				 
				 


